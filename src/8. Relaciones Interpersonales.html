<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Escala Likert - Relaciones Interpersonales</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 20px; 
      line-height: 1.6; 
      background: #f9f9f9; 
      text-align: center;
    }
    h1 { margin-bottom: 10px; }
    .instructions { 
      background: #eef; 
      padding: 10px; 
      border-radius: 8px; 
      margin: 0 auto 20px auto; 
      display: inline-block; 
      text-align: left;
    }
    .question { 
      margin: 15px auto; 
      background: #fff; 
      padding: 15px; 
      border-radius: 8px; 
      box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
      width: 80%;
      text-align: center;
    }
    .question span.num { font-weight: bold; margin-right: 5px; }
    .options { margin-top: 10px; }
    .options label { display: inline-block; margin: 5px 15px; }
    button { margin: 10px 5px; padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; }
    button:first-of-type { background: #4CAF50; color: white; }
    button:last-of-type { background: #f44336; color: white; }
    .result { 
      margin: 20px auto; 
      padding: 15px; 
      background: #fff; 
      border-radius: 8px; 
      box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
      width: 60%; 
    }
  </style>
</head>
<body>
  <h1>Escala Likert - Relaciones Interpersonales</h1>
  <div class="instructions">
    <p><strong>Instrucciones:</strong> Seleccione la opción que mejor refleje su grado de acuerdo con cada afirmación:</p>
    <ul>
      <li>A. Totalmente en desacuerdo</li>
      <li>B. En desacuerdo</li>
      <li>C. Ni de acuerdo, ni en desacuerdo</li>
      <li>D. De acuerdo</li>
      <li>E. Totalmente de acuerdo</li>
    </ul>
  </div>

  <form id="likertForm"></form>

  <button type="button" onclick="calcularResultado()">Calcular resultado</button>
  <button type="button" onclick="reiniciar()">Reiniciar</button>

  <div id="resultado" class="result"></div>

  <script>
    let preguntas = [
      "Escucho con interés las necesidades de mis compañeros.",
      "Transmito la información de manera clara y veraz.",
      "Tomo la iniciativa en contactar a usuarios para dar respuestas oportunas.",
      "Utilizo un lenguaje claro y respetuoso en mis comunicaciones.",
      "Fomento un ambiente laboral basado en el respeto mutuo.",
      "Ignoro las preocupaciones de los demás.", // INVERSA
      "Evito transmitir rumores o información no verificada.",
      "Me comunico de manera efectiva con personas de diferentes contextos.",
      "Brindo apoyo emocional a mis compañeros cuando lo necesitan.",
      "Interrumpo constantemente a los demás cuando hablan.", // INVERSA
      "Muestro disposición para resolver conflictos de manera constructiva.",
      "Atiendo con paciencia a las personas con diferencias funcionales.",
      "Evito dar respuestas claras a las solicitudes de información.", // INVERSA
      "Valoro la diversidad cultural en mi entorno laboral.",
      "Expreso mis ideas de forma respetuosa.",
      "Descalifico las opiniones de los demás.", // INVERSA
      "Reconozco los logros de mis compañeros.",
      "Mantengo una comunicación abierta y transparente.",
      "Doy información precisa para evitar malentendidos.",
      "Me esfuerzo por generar confianza en mis relaciones laborales.",
      "Excluyo a personas que son diferentes a mí.", // INVERSA
      "Brindo retroalimentación constructiva.",
      "Participo activamente en las reuniones de equipo.",
      "Uso un tono cordial en mis interacciones.",
      "Me niego a interactuar con personas de minorías vulnerables.", // INVERSA
      "Practico la empatía con mis compañeros y usuarios.",
      "Me adapto a diferentes estilos de comunicación.",
      "Promuevo un trato equitativo hacia todos.",
      "Evito establecer vínculos con mis compañeros.", // INVERSA
      "Contribuyo al fortalecimiento de un clima laboral positivo."
    ];

    // Índices de preguntas inversas (1-based)
    let inversas = [6, 10, 13, 16, 21, 25, 29];

    const opcionesLetras = ["A", "B", "C", "D", "E"];

    function generarFormulario() {
      const form = document.getElementById("likertForm");
      form.innerHTML = "";
      preguntas.forEach((texto, i) => {
        const div = document.createElement("div");
        div.className = "question";
        const label = document.createElement("label");
        label.innerHTML = `<span class="num">${i + 1}.</span> ${texto}`;
        div.appendChild(label);

        const opcionesDiv = document.createElement("div");
        opcionesDiv.className = "options";
        for (let j = 1; j <= 5; j++) {
          const input = document.createElement("input");
          input.type = "radio";
          input.name = "q" + (i + 1);
          input.value = j;
          const optLabel = document.createElement("label");
          optLabel.appendChild(input);
          optLabel.appendChild(document.createTextNode(" " + opcionesLetras[j - 1]));
          opcionesDiv.appendChild(optLabel);
        }
        div.appendChild(opcionesDiv);
        form.appendChild(div);
      });
    }

    function calcularResultado() {
      let total = 0, contestadas = 0, malas = [];
      let sinResponder = [];

      preguntas.forEach((_, i) => {
        const opciones = document.getElementsByName("q" + (i + 1));
        let valor = null;
        for (let op of opciones) if (op.checked) valor = parseInt(op.value);

        if (valor === null) {
          sinResponder.push(i + 1);
        } else {
          contestadas++;
          if (inversas.includes(i + 1)) valor = 6 - valor;
          total += valor;
          if (valor <= 2) malas.push(i + 1);
        }
      });

      if (sinResponder.length > 0) {
        alert("Debe responder todas las preguntas. Faltan: " + sinResponder.join(", "));
        return;
      }

      const promedio = (total / contestadas).toFixed(2);
      let nivel = "";
      if (promedio >= 4.5) nivel = "Muy alto";
      else if (promedio >= 3.5) nivel = "Alto";
      else if (promedio >= 2.5) nivel = "Medio";
      else if (promedio >= 1.5) nivel = "Bajo";
      else nivel = "Muy bajo";

      document.getElementById("resultado").innerHTML =
        `<p><strong>Puntaje total:</strong> ${total}</p>
         <p><strong>Promedio:</strong> ${promedio}</p>
         <p><strong>Nivel:</strong> ${nivel}</p>
         <p><strong>Preguntas con baja puntuación:</strong> ${malas.join(", ") || "Ninguna"}</p>`;
    }

    function reiniciar() {
      // Barajar preguntas e inversas asociadas
      const combinadas = preguntas.map((texto, idx) => ({
        texto,
        inversa: inversas.includes(idx + 1)
      }));
      for (let i = combinadas.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [combinadas[i], combinadas[j]] = [combinadas[j], combinadas[i]];
      }
      preguntas = combinadas.map(x => x.texto);
      inversas = combinadas
        .map((x, idx) => (x.inversa ? idx + 1 : null))
        .filter(x => x !== null);

      generarFormulario();
      document.getElementById("resultado").innerHTML = "";
    }

    // Inicial
    generarFormulario();
  </script>
</body>
</html>
